-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.api_requests (
  id bigint NOT NULL DEFAULT nextval('api_requests_id_seq'::regclass),
  user_id uuid,
  api_key text,
  path text,
  status_code integer,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT api_requests_pkey PRIMARY KEY (id),
  CONSTRAINT api_requests_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users_custom(id)
);
CREATE TABLE public.app_configs (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  config_key text NOT NULL DEFAULT 'global'::text UNIQUE,
  is_maintenance boolean NOT NULL DEFAULT false,
  enable_user_registration boolean NOT NULL DEFAULT true,
  default_free_plan_limit integer NOT NULL DEFAULT 10,
  conversion_reset_period text NOT NULL DEFAULT 'monthly'::text,
  maintenance_message text DEFAULT 'The site is under maintenance.'::text,
  support_email text DEFAULT 'support@example.com'::text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT app_configs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.contact_messages (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL,
  email text NOT NULL,
  topic text NOT NULL,
  message text NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT timezone('utc'::text, now()),
  CONSTRAINT contact_messages_pkey PRIMARY KEY (id)
);
CREATE TABLE public.conversion_history (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  text text NOT NULL,
  qr_code_url text,
  type text NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT conversion_history_pkey PRIMARY KEY (id),
  CONSTRAINT conversion_history_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users_custom(id)
);
CREATE TABLE public.plans (
  id text NOT NULL,
  name text NOT NULL,
  price_monthly_cents integer NOT NULL,
  monthly_conversions integer NOT NULL,
  features ARRAY NOT NULL DEFAULT '{}'::text[],
  is_active boolean NOT NULL DEFAULT true,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT plans_pkey PRIMARY KEY (id)
);
CREATE TABLE public.users_custom (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  email text NOT NULL UNIQUE,
  name text NOT NULL,
  plan text NOT NULL DEFAULT 'free'::text,
  conversions_used integer NOT NULL DEFAULT 0,
  api_key text NOT NULL,
  bearer_token text NOT NULL,
  created_at timestamp with time zone DEFAULT now(),
  role text NOT NULL DEFAULT 'user'::text,
  plan_started_at timestamp with time zone,
  plan_renews_at timestamp with time zone,
  is_active boolean NOT NULL DEFAULT true,
  CONSTRAINT users_custom_pkey PRIMARY KEY (id)
);